%************************************************
\chapter{Evaluation}\label{ch:evaluation}
%************************************************
\lstset{style=myStyle}

This chapter evaluates the thesis's core claims.  
We present the results for both the ground truth systems and \textsc{XZ} in \autoref{sec:results}.
Afterward, we discuss the results in \autoref{sec:discussion}. At the end in \autoref{sec:threats}, we explain the threads of validity for the results.

\section{Results}\label{sec:results}

In this section, we present the results of the ground truth and of \textsc{XZ}. 
All values are in seconds and are rounded to 3 decimal places.


\subsection*{Ground Truth Results}
We now proceed with evaluating the ground truth systems \textsc{Simple Interactions}, \textsc{Else Clause}, \textsc{Function}, \textsc{Multicollinearity} 
and \textsc{Shared Feature Variable}, which we introduced in \autoref{sec:ground-truth}.

\subsubsection*{Simple Interaction Results}
%Baseline and Blackbox

For the baseline, we have already constructed the {\perfInfluenceModel} in 
\autoref{equ:performanceExamplePIMBaseline} and now proceed with building the model out of the black-box analysis:

\begin{table}[H]
    \centering
    \input{Tables/BlackBox/GTBasic.txt}
    \caption{Black-box {\perfInfluenceModel} for simple interaction}
\end{table}

As expected, the black-box analysis correctly attributes the time spent for each feature in \emph{Simple Interactions}.

 
For the white-box analysis with \autoref{lst:performanceExample} and \autoref{fig:feature_abcd} we build \autoref{alg:xml-abcd} 
in which we declare all the feature variables of \textsc{Simple Interactions}. 
We analyze \autoref{lst:performanceExample} using our white-box analysis, which produces a TEF report file in \autoref{rep:tef-abcd}. 
Afterwards, we use this report to calculate the time spent in each feature region described as in \autoref{math:time} 
and \autoref{math:coefficients}. This produces the following file in \autoref{alg:aggr-tef-abcd},
from which we build the following {\perfInfluenceModel}:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{White-box}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Simple Interaction &   2.0 &  1.0 &  2.0 &  1.0 &  2.0 &   2.0 &  0.0 \\
    \bottomrule
    \end{tabular}
    \caption{White-box {\perfInfluenceModel} for simple interaction}
\end{table}

We group our results in \autoref{aggr:results-simple-interaction} to compare them with each other.

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\ \midrule
    Baseline & 2    & 1 & 2 & 1 & 2 & 2           & 0            \\
    Black-box & 2    & 1 & 2 & 1 & 2 & 2           & 0           \\
    White-box & 2    & 1 & 2 & 1 & 2 & 2           & 0           \\ \bottomrule
    \end{tabular}  
    \caption{Direct comparison between the baseline, black-box and white-box {\perfInfluenceModel}s for \emph{Simple Interaction}}\label{aggr:results-simple-interaction}
\end{table}

Out of \autoref{aggr:results-simple-interaction} we now calculate $\overline{error}$ and $\overline{similarity}$
for both white-box and black-box {\perfInfluenceModel}s:

\begin{table}[H]
\begin{minipage}{.5\linewidth}
    \centering
    \begin{tabular}{lr}
    \toprule
    RQ1     & $\overline{error}$         \\ \midrule
    Black-box & 0              \\
    White-box & 0              \\ \bottomrule
    \end{tabular}  
    \caption{Results RQ1}
\end{minipage}%
\begin{minipage}{.5\linewidth}
    \centering
    \begin{tabular}{lr}
        \toprule
        RQ2     & $\overline{similarity}$    \\ \midrule
        Black-box$_\text{WB}$ & 0              \\
        White-box$_\text{BB}$ & 0              \\ \bottomrule
        \end{tabular}  
        \caption{Results RQ2}
\end{minipage} 
\end{table}

\subsubsection*{Else Clause Results}

For \textsc{Else Clause} system we add an else cause that is executed when \emph{A} is not selected. 
The \perfInfluenceModel of the baseline is as follows:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{Baseline}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Else Clause &   4 &  -1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{Baseline {\perfInfluenceModel} for \emph{Else Clause}}
\end{table}

We attributed the time spent in the else case to \emph{Base} since it represents the time spent in the system when no feature is selected.
Therefore, when selecting feature \emph{A}, the system gets faster by one second. 

\begin{table}[H]
    \centering
    \input{Tables/BlackBox/GTElse.txt}
\end{table}

To build the {\perfInfluenceModel} for the white-box we have to take a closer look at \autoref{table:WB-Else-Case} 
especially the configurations \{\} and \{\emph{A}\} in which we can see that even when the feature \emph{A} is not selected 
it still got an influence of \emph{2} seconds but when selected its influence is reduced to \emph{1} second.
This means that the selection of feature \emph{A} increases the run time by \emph{1} second and the \emph{Base} 
feature is \emph{4} seconds.
With this information in mind, we build the following {\perfInfluenceModel}:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{White-box}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Else Clause &   4 &  -1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{White-box {\perfInfluenceModel} for \emph{Else Clause}}
\end{table}

We group the {\perfInfluenceModel}s for \emph{Else Clause} in the following table:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\ \midrule
    Baseline & 4    & -1 & 2 & 1 & 2 & 2           & 0            \\
    Black-box & 4    & -1 & 2 & 1 & 2 & 2           & 0           \\
    White-box & 4    & -1 & 2 & 1 & 2 & 2           & 0           \\ \bottomrule
    \end{tabular}  
    \caption{Direct comparison between the baseline, black-box and white-box {\perfInfluenceModel}s for \emph{Else Clause}}\label{aggr:results-else-clause}
\end{table}

As we can see, we were able to build correct {\perfInfluenceModel} with both analyses. 
However, we had to incorporate domain-specific knowledge and analyze the measurement results to build the white-box model. 
We now calculate $\overline{error}$ and $\overline{similarity}$ for both white-box and black-box {\perfInfluenceModel}s:

\begin{table}[H]
    \begin{minipage}{.5\linewidth}
        \centering
        \begin{tabular}{lr}
        \toprule
        RQ1     & $\overline{error}$         \\ \midrule
        Black-box & 0              \\
        White-box & 0              \\ \bottomrule
        \end{tabular}  
        \caption{Results RQ1}
    \end{minipage}%
    \begin{minipage}{.5\linewidth}
        \centering
        \begin{tabular}{lr}
            \toprule
            RQ2     & $\overline{similarity}$   \\ \midrule
            Black-box$_\text{WB}$ & 0              \\
            White-box$_\text{BB}$ & 0              \\ \bottomrule
            \end{tabular}  
            \caption{Results RQ2}
    \end{minipage} 
    \end{table}

Since the {\perfInfluenceModel}s are all the same both scores are 0.

\subsubsection*{Function}
We now add a function call to our system in which we spend time instead of in the main function. 
We hypothesize that this should neither change the {\perfInfluenceModel}s for white-box and black-box. 
The baseline {\perfInfluenceModel} is as follows:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{Baseline}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Function &   2 &  1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{Baseline {\perfInfluenceModel} for \emph{Function}}
\end{table}

Since we did not increase the time spent inside feature \emph{A} and instead spent the time inside a function, 
the baseline {\perfInfluenceModel} does not change compared to the one in \emph{Simple Interaction}. The {\perfInfluenceModel} for 
the black-box is as follows: 

\begin{table}[H]
    \centering
    \input{Tables/BlackBox/GTFunction.txt}
    \caption{Black-box {\perfInfluenceModel} for \emph{Function}}
\end{table}
    
As expected, the black-box {\perfInfluenceModel} did not change since the measurements are nearly identical as those for the 
\emph{Simple Interaction} system. Therefore, the models learned from the data should be the same. 
The {\perfInfluenceModel} we build from the white-box analysis measurements from \autoref{table:WB-Function} as follows:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{White-box}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Function &   2 &  1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{Baseline {\perfInfluenceModel} for \emph{Function}}
\end{table}

The white-box {\perfInfluenceModel} also looks as expected since \textsc{VaRA} is able to successfully trace the time 
spent inside functions as well. We group the {\perfInfluenceModel}s for \emph{Function} in the following table:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\ \midrule
    Baseline & 2    & 1 & 2 & 1 & 2 & 2           & 0            \\
    Black-box & 2   & 1 & 2 & 1 & 2 & 2           & 0            \\
    White-box & 2   & 1 & 2 & 1 & 2 & 2           & 0            \\ \bottomrule
    \end{tabular}  
    \caption{Direct comparison between the baseline, black-box and white-box {\perfInfluenceModel}s for \emph{Function}}\label{aggr:results-function}
\end{table}

Now when comparing the {\perfInfluenceModel} with each other, we see that both white-box and black-box are accurate for the \emph{Function}
system. We still calculate $\overline{error}$ and $\overline{similarity}$ to answer our research questions:

\begin{table}[H]
    \begin{minipage}{.5\linewidth}
        \centering
        \begin{tabular}{lr}
        \toprule
        RQ1     & $\overline{error}$         \\ \midrule
        Black-box & 0              \\
        White-box & 0              \\ \bottomrule
        \end{tabular}  
        \caption{Results RQ1}
    \end{minipage}%
    \begin{minipage}{.5\linewidth}
        \centering
        \begin{tabular}{lr}
            \toprule
            RQ2     & $\overline{similarity}$   \\ \midrule
            Black-box$_\text{WB}$ & 0              \\
            White-box$_\text{BB}$ & 0              \\ \bottomrule
            \end{tabular}  
            \caption{Results RQ2}
    \end{minipage} 
    \end{table}

Since all the {\perfInfluenceModel} for the \emph{function} system are the same both $\overline{error}$ and $\overline{similarity}$ 
are 0.

\subsubsection*{Multicollinearity}
For the \emph{Multicollinearity} system, we introduce multicollinearity by changing feature \emph{B} from optional to mandatory. 
This, in consequence, changes the number of configurations from 16 to 8. The {\perfInfluenceModel} for the baseline looks as follows:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}   
    \toprule
    $\Pi_{Baseline}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Multicollinearity &   2 &  1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{Baseline {\perfInfluenceModel} for \emph{Multicollinearity}}
\end{table}

When comparing the baseline {\perfInfluenceModel} of \emph{Simple Interaction} and \emph{Multicollinearity} system 
we see that they are the same, since the time spent in each feature did not change at all. We proceed with 
the {\perfInfluenceModel} for the black-box analysis:

\begin{table}[H]
    \centering
    \input{Tables/BlackBox/GTMulticollinearity.txt}
    \caption{Black-box {\perfInfluenceModel} for \emph{Multicollinearity}}
\end{table}

As we can see, the {\perfInfluenceModel} of the black-box analysis is severely different due to the introduction of multicollinearity. 
The first change that we see is that due to feature \emph{B} being mandatory, 
the feature \emph{A} and the feature interaction $A \land B$ are perfect Multicollinear since feature \emph{B} 
is always selected in for every configuration with feature \emph{A}. Since we add features iteratively 
as described in \autoref{ch:iterative-vif}, therefore, since $A \land B$ introduces perfect multicollinearity, 
the feature interaction is not added to the model. 

In addition, due to multicollinearity, the time distribution also changed. While features \emph{C} and \emph{D} are still correct, 
we have a change for features \emph{Base} with an increase of 2 seconds, 
\emph{A} with an increase of 2 seconds, and \emph{B} with a decrease of 2 seconds. 
We assume that the time spent in \emph{B} is attributed to \emph{Base} since for the black-box, 
they are indistinguishable and the 2 seconds spent in the interaction $A \land B$ is attributed to \emph{A}.

We now build the \perfInfluenceModel for the white-box from the measurements of \autoref{table:WB-Multicollinearity}:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi_{Whitebox}$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\
    \midrule
    Multicollinearity &   2 &  1 &  2 &  1 &  2 &   2 &  0 \\
    \bottomrule
    \end{tabular}
    \caption{Whitebox {\perfInfluenceModel} for \emph{Multicollinearity}}
\end{table}

As we can see, the white-box {\perfInfluenceModel} still correctly attribute the time spent in each feature and feature
interaction, since the number of configurations does not change the detection of feature regions and thereby does not 
change the \perfInfluenceModel. We group the {\perfInfluenceModel}s as follows:

\begin{table}[H]
    \centering
    \begin{tabular}{lrrrrrrr}
    \toprule
    $\Pi$    & Base & A & B & C & D & A $\land$ B & C $\land$ D  \\ \midrule
    Baseline & 2    & 1 & 2 & 1 & 2 & 2           & 0            \\
    Black-box & 4   & 3 & 0 & 1 & 2 & 0           & 0            \\
    White-box & 2   & 1 & 2 & 1 & 2 & 2           & 0            \\ \bottomrule
    \end{tabular}  
    \caption{Direct comparison between the baseline, black-box and white-box {\perfInfluenceModel}s for \emph{Multicolinearity}}
    \label{aggr:results-mullti  }
\end{table}

Since the term $A \land B$ does not exist in the black-box {\perfInfluenceModel} we add and assign an influence of 0. 
This is possible since we only remove terms before using multiple linear regression to get a better fit of the model.
Therefore, adding a term with 0 influence does not change the {\perfInfluenceModel}. 
We now calculate $\overline{error}$ and $\overline{similarity}$:

\section{Discussion}\label{sec:discussion}

In this section, discuss your results.

\section{Threats to Validity}\label{sec:threats}

In this section, discuss the threats to internal and external validity.
